<!DOCTYPE html>
<html>
  <head>
    <title>Block Breaker! WOOT!</title>
    <script type="text/javascript">
      // requestAnim shim layer
      //window.requestAnimFrame = (function(callback){
      //  window.setTimeout(callback, 1000 / 60);});
      //window.requestAnimFrame = (function(){
      //  return  window.requestAnimationFrame       || 
      //          window.webkitRequestAnimationFrame || 
      //          window.mozRequestAnimationFrame    || 
      //          window.oRequestAnimationFrame      || 
      //          window.msRequestAnimationFrame     || 
      //          function(callback){
      //            window.setTimeout(callback, 1000 / 60);
      //          };
      //});
    </script>
    
  </head>
  <body>
    <canvas id="game" width="1000" height="600"></canvas>
    <script type="text/javascript">
      var gameCanvas = document.getElementById("game");
      var ctx = gameCanvas.getContext("2d");
      var colors = ["#FF0000", "#00FF00", "#0000FF"]

      var gap = 5;
      var blockWidth = 80;
      var blockHeight = 40;
      var blockColumns = 10;
      var blockRows = 4;
      for(var j=0; j < blockRows; j++) {
        ctx.fillStyle = colors[j%colors.length];
        for(var i=0; i < blockColumns; i++) {
          ctx.fillRect(i * (gap + blockWidth), j * (gap + blockHeight), blockWidth, blockHeight);
        }
      }

      var ballOldX = gameCanvas.width / 2;
      var ballOldY = gameCanvas.height - 50;
      var ballX = 0;
      var ballY = 0;
      var ballRadius = 10;

      function nextStep() {
        console.log("x, y: " + ballX + ", " + ballY);
        ballX = ballOldX - 1;
        ballY = ballOldY - 1;
        var gameCanvas = document.getElementById("game");
        var ctx = gameCanvas.getContext("2d");
        ctx.fillStyle = "#FFFFFF";
        ctx.beginPath();
        ctx.arc(ballOldX, ballOldY, ballRadius + 2, 0, 2*Math.PI, false);
        ctx.fill();
        ctx.fillStyle = "#FF0000";
        ctx.beginPath();
        ctx.arc(ballX, ballY, ballRadius, 0, 2*Math.PI, false);
        ctx.fill();

        ballOldX = ballX;
        ballOldY = ballY;

        if(ballX > -ballRadius && ballY > -ballRadius) {
          //requestAnimFrame(function() {
          requestAnimationFrame(function() {
              nextStep();
          });
        }
      }
      nextStep();
    </script>
  </body>

</html>
